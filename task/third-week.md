# Третья неделя

А вот и финишная прямая — осталось добавить взаимодействие пользователя с постами, этакий элемент социальной сети.

Весь описанный ниже функционал должен работать для **любого** поста открытого в модальном окне из предыдущего раздела.

### Удаление постов

При клике на `#delete-post` должен отправляться DELETE-запрос (метод [DELETE](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/DELETE)) на адрес

```
https://c-gallery.polinashneider.space/api/v1/posts/<id_поста>/
```

После получения ответа от бэкенда (неважно, успех или не успех) модальное окно должно закрыться.

Если удаление прошло успешно, нужно показать пользователю соответствующее уведомление, **повторно** запросить с сервера посты и отрисовать их.

Если при удалении произошла ошибка, достаточно показать уведомление об этом, не запрашивая данные — ведь количество постов не изменилось.

### Отображение количества лайков

Внутри `.statistics__likes span` должно отображаться количество лайков текущего поста.

### Добавление лайка

При клике на `.fa-heart` элементу `.statistics__likes` должен добавиться класс `.liked`. При этом цифра лайков увеличивается на единицу.

Для простановки лайка на сервере отправляй POST-запрос на адрес

```
https://c-gallery.polinashneider.space/api/v1/posts/<id_поста>/like/
```

### Отображение количества комментариев

Внутри `.statistics__comments span` должно отображаться количество комментариев к данному посту.

### Отображение комментариев

Сами комментарии должны быть выведены внутри `.comments__content`. Возможно, тебе захочется вынести `.comments__item` в `<template>` и переиспользовать его.

### Добавление комментариев

Добавление нового комментария должно происходить при нажатии Enter в текстовом поле `#post-comment`, либо при нажатии на кнопку `.comments-button`. Отправка пустых комментариев запрещена.

После отправки комментария текстовое поле должно очищаться.

Для сохранения комментария на бэкенде должен отправляться POST-запрос, содержащий в теле текст комментария и id поста, по адресу

```
https://c-gallery.polinashneider.space/api/v1/comments/
```

Формат запроса:

```json
{
  "text": "string",
  "post": 0
}
```

Комментарий должен добавляться в `.comments__content` **только после** получения успешного ответа от бэкенда. В случае ошибки добавления комментария нужно показать уведомление об этом пользователю.

## Задания под звездочкой

Если ты справилась с лайками и комментариями, и хочешь большего, можно добавить персонализацию текущему аккаунту. Давай займемся установкой кастомной аватарки и редактированием биографии. Традиционно, можешь реализовать пункты, которые тебе нравятся, или все сразу.

### Получение данных с сервера

Этот пункт имеет смысл делать после того как у тебя появятся кастомные данные (аватарка, никнейм, имя, биография).

GET-запрос по адресу

```
https://c-gallery.polinashneider.space/api/v1/users/me/
```

вернет тебе информацию о текущем пользователе.

Тебе нужно будет подставить ее в нужные места в интерфейсе, включая аватарки в комментариях к посту.

Данные пользователя имеет смысл запрашивать сразу при загрузке страницы. Возможно, ты захочешь сохранить их в LocalStorage.

### Загрузка аватарки

При клике на аватарку аккаунта `#profile-avatar` должен открываться диалог файловой системы, позволяющий выбрать фото с компьютера. Тебе придется чуть поправить верстку, добавив форму и поле для файла. Можешь посмотреть, как это сделано в Инстаграм.

После выбора файла с компьютера должен отправляться PATCH-запрос на сервер с данными загруженного файла по адресу

```
https://c-gallery.polinashneider.space/api/v1/users/me/
```

Так как запрос будет содержать картинку, используй FormData.

PATCH-запрос по адресу `/users/me` поддерживает возможность обновления большого количества полей (часть из них тебе пригодится в следующем пункте). Для обновления аватарки передавай на сервер только поле `photo`. Опциональные поля пока опусти.

В случае успешной загрузки изображения аватарка профиля должна тут же обновиться. Если во время загрузки что-то пошло не так, пользователю должно быть показано уведомление об ошибке.

### Редактирование персональных данных

При клике на `#edit-bio` должно открываться модальное окно `#edit-bio-modal`. В качестве начальных значений должны подставляться актуальные никнейм, имя (жирная строчка) и биография пользователя.

Все поля кроме никнейма являются опциональными, и их можно стереть. Если не заполнено обязательное поле, кнопка сохранения (`#bio-save`) блокируется и показывается сообщение об ошибке под полем (`.required-field`)

При клике на кнопку «Сохранить» (`#bio-save`) должен отправляться PATCH-запрос по адресу `/users/me` (см. предыдущий пункт).

Запрос также должен иметь тип `multipart/form-data`, то есть ты будешь отправлять объект типа FormData.

После чего модальное окно закрывается.

В случае успеха пользователю показывается уведомление об этом и данные в шапке профиля обновляются.

В случае ошибки сохранения данных должено быть просто показано уведомление.

### Валидация личных данных

По мере того как пользователь вводит описание профиля в поле `#bio` обновляется счетчик количества символов `.bio-count`.

Если значение счетчика превышает 150, кнопка сохранения блокируется и выводится текст об ошибке (с поля `.max-capacity` убирается класс `v-hidden`)
